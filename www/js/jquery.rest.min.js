/*! jQuery REST Client - v0.0.5 - 2013-07-29
 * https://github.com/jpillora/jquery.rest
 * Copyright (c) 2013 Jaime Pillora; Licensed MIT */
!function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l;g=function(a){throw"ERROR: jquery.rest: "+a},i=function(a){var b;for(b="";a-->0;)b+="  ";return b},f=function(a){return window.btoa||g("You need a polyfill for 'btoa' to use basic auth."),window.btoa(a)},j=function(a){return window.JSON||g("You need a polyfill for 'JSON' to use stringify."),window.JSON.stringify(a)},h=function(a,b){var c;return c=function(){},c.prototype=a,$.extend(!0,new c,b)},k=function(a){return a&&$.isPlainObject(a)?($.each(a,function(a){return void 0===d[a]?g("Unknown option: '"+a+"'"):void 0}),null):!1},l=function(a,b){return"string"!==$.type(b)?g("'"+a+"' must be a string"):void 0},e=function(){return alert('"delete()" has been deprecated. Please use "destroy()" or "del()" instead.')},d={url:"",cache:0,cachableMethods:["GET"],stringifyData:!1,stripTrailingSlash:!1,password:null,username:null,verbs:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},ajax:{dataType:"json"}},a=function(){function a(a){this.parent=a,this.c={}}return a.prototype.valid=function(a){var b;return b=(new Date).getTime()-a.getTime(),b<=1e3*this.parent.opts.cache},a.prototype.key=function(a){var b,c=this;return b="",$.each(a,function(a,d){return b+=a+"="+($.isPlainObject(d)?"{"+c.key(d)+"}":d)+"|"}),b},a.prototype.get=function(a){var b;return(b=this.c[a])?this.valid(b.created)?b.data:void 0:void 0},a.prototype.put=function(a,b){return this.c[a]={created:new Date,data:b}},a.prototype.clear=function(a){var b=this;return a?$.each(this.c,function(c){return c.match(a)?delete b.c[c]:void 0}):this.c={}},a}(),c=function(){function a(a,b,c,e){this.name=a,this.method=b,null==c&&(c={}),this.parent=e,l("name",this.name),l("method",this.method),k(c),this.parent[this.name]&&g("Cannot add Verb: '"+a+"' already exists"),this.method=b.toUpperCase(),c.url||(c.url=""),this.opts=h(this.parent.opts,c),this.root=this.parent.root,this.custom=!d.verbs[this.name],this.call=$.proxy(this.call,this),this.call.instance=this}return a.prototype.call=function(){var a;return a=this.parent.extractUrlData(this.method,arguments),this.custom&&(a.url+=this.opts.url||this.name),this.parent.ajax.call(this,this.method,a.url,a.data)},a.prototype.show=function(a){return console.log(i(a)+this.name+": "+this.method)},a}(),b=function(){function b(a,c,d){null==c&&(c={}),k(c),d&&d instanceof b?(this.name=a,l("name",this.name),this.constructChild(d,c)):(this.url=a||"",l("url",this.url),this.constructRoot(c))}return b.prototype.constructRoot=function(b){return this.opts=h(d,b),this.root=this,this.numParents=0,this.urlNoId=this.url,this.cache=new a(this),this.parent=null,this.name=this.opts.name||"ROOT"},b.prototype.constructChild=function(a,c){return this.parent=a,l("name",this.name),this.parent instanceof b||this.error("Invalid parent"),this.parent[this.name]&&this.error("'"+name+"' already exists"),c.url||(c.url=""),this.opts=h(this.parent.opts,c),this.root=this.parent.root,this.numParents=this.parent.numParents+1,this.urlNoId=this.parent.url+(""+(this.opts.url||this.name)+"/"),this.url=this.urlNoId+(":ID_"+this.numParents+"/"),$.each(this.opts.verbs,$.proxy(this.addVerb,this)),this.destroy?(this.del=this.destroy,this["delete"]=e):void 0},b.prototype.error=function(a){return g("Cannot add Resource: "+a)},b.prototype.add=function(a,c){return this[a]=new b(a,c,this)},b.prototype.addVerb=function(a,b,d){return this[a]=new c(a,b,d,this).call},b.prototype.show=function(a){return null==a&&(a=0),a>25&&g("Plugin Bug! Recursion Fail"),this.name&&console.log(i(a)+this.name+": "+this.url),$.each(this,function(b,d){return"function"===$.type(d)&&d.instance instanceof c&&"del"!==b?d.instance.show(a+1):void 0}),$.each(this,function(c,d){return"parent"!==c&&"root"!==c&&d instanceof b?d.show(a+1):void 0}),null},b.prototype.toString=function(){return this.name},b.prototype.extractUrlData=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q,r;for(j=[],f=null,o=0,q=b.length;q>o;o++)c=b[o],m=$.type(c),"string"===m||"number"===m?j.push(c):$.isPlainObject(c)&&null===f?f=c:g("Invalid argument: "+c+" ("+m+")."+" Must be strings or ints (IDs) followed by one optional plain object (data).");for(l=j.length,d="create"!==a,e="update"!==a&&"delete"!==a,n=null,d&&l===this.numParents&&(n=this.url),e&&l===this.numParents-1&&(n=this.urlNoId),null===n&&(e&&(k=this.numParents-1),d&&(k=(k?k+" or ":"")+this.numParents),g("Invalid number of ID arguments, required "+k+", provided "+l)),h=p=0,r=j.length;r>p;h=++p)i=j[h],n=n.replace(new RegExp("/:ID_"+(h+1)+"/"),"/"+i+"/");return{url:n,data:f}},b.prototype.ajax=function(a,b,c,d){var e,h,i,k,l,m=this;return null==d&&(d={}),a||g("method missing"),b||g("url missing"),this.opts.username&&this.opts.password&&(h=f(this.opts.username+":"+this.opts.password),d.Authorization="Basic "+h),c&&this.opts.stringifyData&&(c=j(c),d["Content-Type"]="application/json"),this.opts.stripTrailingSlash&&(b=b.replace(/\/$/,"")),e={url:b,type:a,headers:d},c&&(e.data=c),e=$.extend(!0,{},this.opts.ajax,e),l=this.opts.cache&&$.inArray(a,this.opts.cachableMethods)>=0,l&&(i=this.root.cache.key(e),k=this.root.cache.get(i))?k:(k=$.ajax(e),l&&k.done(function(){return m.root.cache.put(i,k)}),k)},b}(),b.defaults=d,$.RestClient=b}.call(this);